"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
print(GenomicRanges::mcols(query)[GenomicRanges::mcols(query)$genome == hub_genome, c('genome','description')])
print(GenomicRanges::mcols(gr)[GenomicRanges::mcols(query)$genome == hub_genome, c('genome','description')])
print(GenomicRanges::mcols(gr)[GenomicRanges::mcols(gr)$genome == hub_genome, c('genome','description')])
print(GenomicRanges::mcols(anno_gr)[GenomicRanges::mcols(anno_gr)$genome == hub_genome, c('genome','description')])
print(GenomicRanges::mcols(anno_gr)[GenomicRanges::mcols(anno_gr)$genome == hub_genome, c('genome','description')])
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
"hg38_cpgs"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# Use NCBI style for seqlevels
seqlevelsStyle(anno_gr) <- "NCBI"
ov <- annotate_regions(gr, anno_gr, ignore.strand = TRUE)
sub(":.*$", "", ov$annot$id)
table(sub(":.*$", "", ov$annot$id))
?build_annotations
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
tcga_cesa <- load_cesa('tcga_cesa.rds')
CLCA_Variant = clca_cesa$variants
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
TCGA_variant_CES <- tcga_cesa$selection$TCGA_variant_CES
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
?accessionhub()
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
AnnotationHub
annotations
annotations$type
AnnotationHub
?AnnotationHub()
# Load the neccessary package
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
tcga_cesa <- load_cesa('tcga_cesa.rds')
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
CLCA_Variant = clca_cesa$variants
nrow(CLCA_Variant)
nrow(CLCA_variant_CES)
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
library(annotatr)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
# Load the neccessary package
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
tcga_cesa <- load_cesa('tcga_cesa.rds')
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
TCGA_variant_CES <- tcga_cesa$selection$TCGA_variant_CES
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
"hg38_lncrna_gencode"
)
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
hub <- AnnotationHub()
library(AnnotationHub)
hub <- AnnotationHub()
query(hub, "gencode.v31")
# Then download manually
resource <- hub[["AH75123"]]
download.file("https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_31/gencode.v31.long_noncoding_RNAs.gff3.gz",
destfile = "gencode.v31.long_noncoding_RNAs.gff3.gz")
download.file(
url = "http://hgdownload.soe.ucsc.edu/goldenPath/hg38/database/wgEncodeGencodeCompV31.txt.gz",
destfile = "gencode.v31.ucsc.lncRNA.txt.gz",
method = "libcurl", timeout = 300
)
download.file("https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_31/gencode.v31.long_noncoding_RNAs.gff3.gz",
destfile = "gencode.v31.long_noncoding_RNAs.gff3.gz", timeout = 300)
download.file(
url = "http://hgdownload.soe.ucsc.edu/goldenPath/hg38/database/wgEncodeGencodeCompV31.txt.gz",
destfile = "gencode.v31.ucsc.lncRNA.txt.gz",
method = "libcurl", timeout = 300
)
download.file(
url = "https://ftp.ensembl.org/pub/release-108/gff3/homo_sapiens/Homo_sapiens.GRCh38.108.gff3.gz",
destfile = "gencode.v38.gff3.gz",
method = "libcurl", timeout = 300
)
download.file(
url = "https://ftp.ensembl.org/pub/release-108/gff3/homo_sapiens/Homo_sapiens.GRCh38.108.gff3.gz",
destfile = "gencode.v38.gff3.gz",
method = "libcurl", timeout = 300
)
lncrna_gr <- import("gencode.v31.long_noncoding_RNAs.gff3.gz")
query(hub, c("gencode", "lncRNA", "gff3"))
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# Load the neccessary package
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
library(AnnotationHub)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
tcga_cesa <- load_cesa('tcga_cesa.rds')
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
TCGA_variant_CES <- tcga_cesa$selection$TCGA_variant_CES
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
cache_path <- tools::file_path_as_absolute(AnnotationHub::getAnnotationHubOption("CACHE"))
print(cache_path)
# Delete the corrupted cache
unlink(cache_path, recursive = TRUE)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom" ,
#"hg38_cpgs",
#"hg38_lncrna_gencode"
)
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
#"hg38_cpgs",
#"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
cache_path <- tools::file_path_as_absolute(AnnotationHub::getAnnotationHubOption("CACHE"))
print(cache_path)
# Delete the corrupted cache
unlink(cache_path, recursive = TRUE)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
cache_path <- tools::file_path_as_absolute(AnnotationHub::getAnnotationHubOption("CACHE"))
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
library(AnnotationHub)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
library(ces.refset.hg38)
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
library(AnnotationHub)
# Load the neccessary package
library(ces.refset.hg38)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
#"hg38_cpgs",
#"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
cache_path <- tools::file_path_as_absolute(AnnotationHub::getAnnotationHubOption("CACHE"))
print(cache_path)
# Delete the corrupted cache
unlink(cache_path, recursive = TRUE)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# Load the neccessary package
library(ces.refset.hg38)
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
library(AnnotationHub)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
#"hg38_cpgs",
#"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
cache_path <- tools::file_path_as_absolute(AnnotationHub::getAnnotationHubOption("CACHE"))
print(cache_path)
# Delete the corrupted cache
unlink(cache_path, recursive = TRUE)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# Load the neccessary package
library(ces.refset.hg38)
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
library(AnnotationHub)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
#"hg38_cpgs",
#"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
# Use NCBI style for seqlevels
seqlevelsStyle(anno_gr) <- "NCBI"
ov <- annotate_regions(gr, anno_gr, ignore.strand = TRUE)
sub(":.*$", "", ov$annot$id)
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
#"hg38_cpgs",
"hg38_lncrna_gencode"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
lncRNA_gr <- import("gencode.v31.long_noncoding_RNAs.gff3.gz")
anno_gr = c(anno_gr, lncRNA_gr)
anno_gr
seqlevelsStyle(lncRNA_gr) <- seqlevelsStyle(anno_gr)
seqlevelsStyle(lncRNA_gr) = "NCBI"
# Use NCBI style for seqlevels
seqlevelsStyle(anno_gr) <- "NCBI"
# Use NCBI style for seqlevels
seqlevelsStyle(anno_gr) <- "NCBI"
anno_gr = c(anno_gr, lncRNA_gr)
lncRNA_gr <- keepSeqlevels(lncRNA_gr, intersect(seqlevels(anno_gr), seqlevels(lncRNA_gr)), pruning.mode = "coarse")
anno_gr <- c(anno_gr, lncRNA_gr)
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom",
#"hg38_lncrna_gencode"
)
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
#"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
unlink(cache_dir, recursive = TRUE)
cache_dir <- AnnotationHub::getAnnotationHubOption("CACHE")
print(cache_dir)
unlink(cache_dir, recursive = TRUE)
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
#"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
unlink(cache_dir, recursive = TRUE)
# Load the neccessary package
library(ces.refset.hg38)
library(cancereffectsizeR)
library(data.table)
library(ggplot2)
library(GenomicRanges)
library(annotatr)
library(AnnotationHub)
# Load the CESAnalysis objects
clca_cesa <- load_cesa('clca_cesa.rds')
# Build data.table for visualization
CLCA_variant_CES <- clca_cesa$selection$CLCA_variant_CES
CLCA_variant_CES$chr = clca_cesa$variants$chr[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$start = clca_cesa$variants$start[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
CLCA_variant_CES$end = clca_cesa$variants$end[match(CLCA_variant_CES$variant_id, clca_cesa$variants$variant_id)]
## For HCC-CLCA
# Build a 1-bp GRanges of variant position
gr <- GRanges(
seqnames   = CLCA_variant_CES$chr,
ranges     = IRanges(start = CLCA_variant_CES$start,
end   = CLCA_variant_CES$end  ),
strand     = "*",
variant_id = CLCA_variant_CES$variant_id  # needed for the join
)
seqlevelsStyle(gr) <- "NCBI"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom"
"hg38_lncrna_gencode"
# annotation for regions
annots <- c(
"hg38_basicgenes",
"hg38_enhancers_fantom",
"hg38_lncrna_gencode"
)
anno_gr <- build_annotations(genome = "hg38", annotations = annots)
